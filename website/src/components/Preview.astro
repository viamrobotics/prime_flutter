---
interface Props {
  // The route path for the specific widget in the Flutter app.
  // Example: "button?style=primary"
  src: string;
  // Optional height for the iframe.
  height?: string;
  // Optional width for the iframe. Defaults to 100%.
  width?: string;
  // Optional title for accessibility.
  title?: string;
}

const { src, height = "400px", width = "100%", title = "Preview" } = Astro.props;

// We assume the Flutter app is built into the 'flutter' directory in public.
// Adjust for base path (e.g., /prime_flutter)
const base = import.meta.env.BASE_URL === '/' ? '' : import.meta.env.BASE_URL;
// Ensure no double slash if base ends with /
const cleanBase = base.endsWith('/') ? base.slice(0, -1) : base;
const flutterSrc = `${cleanBase}/flutter/index.html#/${src}`;
---

<div class="preview-container">
  <iframe
    src={flutterSrc}
    width={width}
    style={{ height }}
    title={title}
    class="preview-iframe"
    loading="lazy"
  ></iframe>
  <div class="code-container">
    <slot />
  </div>
</div>

<style>
  .preview-container {
    border: 1px solid var(--sl-color-gray-5);
    border-radius: 8px;
    background-color: var(--sl-color-black);
    overflow: hidden;
    margin-bottom: 2rem;
    box-shadow: var(--sl-shadow-md);
  }

  .preview-iframe {
    border: none;
    display: block;
    width: 100%;
    background-color: transparent; 
  }

  .code-container {
    padding: 1rem;
    border-top: 1px solid var(--sl-color-gray-5);
    background-color: var(--sl-color-gray-6);
  }
</style>
